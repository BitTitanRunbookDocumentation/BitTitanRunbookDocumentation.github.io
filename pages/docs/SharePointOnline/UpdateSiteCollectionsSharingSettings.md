#SharePointOnline##UpdateSiteCollections'SharingSettings###SYNOPSIS```UpdatesthesharingsettingsofoneormoresitecollectionsinSharePointOnline```###DESCRIPTION```UpdatesthesharingsettingsofoneormoresitecollectionsinSharePointOnline.ThistaskmakesuseoftheSet-SPOSitecmdlettoupdatethevarioussettings.```###INPUTS```Office365AdministrativeCredentialsMSPCompleteendpointcontainingtheadministrativeusernameandpasswordfortheOffice365accountTheOrganizationNameextendedpropertyisrequired-itistheportionofthedomainbeforethe'.onmicrosoft.com'Example:Ifthefulldomainis'contoso.onmicrosoft.com',theOrganizationNameis'contoso'.Single-inputscenario:UrlNameSinglestring,required.UrlPathSinglestring,optional.Possiblevaluesare'sites'or'teams'.Thedefaultvalueusedis'sites'ifnotspecified.DefaultLinkPermissionSinglestring,optional.Thissetsthedefaultlinkpermissionforthesitecollection.Possiblevaluesare'None','View'and'Edit'.Thispropertyisnotmodifiedifnotspecified.None-Respectsthedefaultorganizationlinkpermission.View-Thedefaultlinkpermissionis'view'.Edit-Thedefaultlinkpermissionis'edit'.DefaultSharingLinkTypeSinglestring,optional.ThissetsthedefaultlinktypeforthesitecollectionPossiblevaluesare'None','AnonymousAccess','Internal'and'Direct'.Thispropertyisnotmodifiedifnotspecified.None-Respectsthedefaultorganizationlinktype.AnonymousAccess-Thedefaultlinktypeis'AnonymousAccess'oranyone.Internal-Thedefaultlinktypeis'Organization'orcompanyshareable.Direct-Thedefaultlinktypeis'SpecificPeople'.SharingAllowedDomainListOneormorestringsseparatedbyanewline,optional.Thisspecifiesalistofemaildomainsthatareallowedasexternalcollaborators.Thispropertyisnotmodifiedifnotspecified.Tocleartheexistinglist,usethevalueof$CLEAR_VALUE_FLAGasdefinedinBitTitan.Runbooks.Common.SharingBlockedDomainListOneormorestringsseparatedbyanewline,optional.Thisspecifiesalistofemaildomainsthatareblockedasexternalcollaborators.Thispropertyisnotmodifiedifnotspecified.Tocleartheexistinglist,usethevalueof$CLEAR_VALUE_FLAGasdefinedinBitTitan.Runbooks.Common.SharingCapabilitySinglestring,optional.Thissetsthelevelofsharingavailableforthesitecollection.Possiblevaluesare'Disabled','ExistingExternalUserSharingOnly','ExternalUserSharingOnly',and'ExternalUserAndGuestSharing'.Thispropertyisnotmodifiedifnotspecified.Disabled-Sharingoutsidetheorganizationisnotallowed.ExistingExternalUserSharingOnly-Sharingwithexternalusersisonlyallowediftheyalreadyexistintheorganization'sdirectory.ExternalUserSharingOnly-Sharingwithexternalusersisallowediftheysigninasauthenticatedusers.ExternalUserAndGuestSharing-Sharingwithexternalusersandusinganonymousaccesslinksisallowed.SharingDomainRestrictionModeSinglestring,optional.Thisselectswhetherthedomain'Allow'or'Block'list,orneither,isusedtocontrolexternalsharing.Possiblevaluesare'None','AllowList'and'BlockList'.Thispropertyisnotmodifiedifnotspecified.None-Neitherthe'Allow'nor'Block'listisused.AllowList-The'Allow'listisused.BlockList-The'Block'listisused.Multiple-inputscenario:SiteCollectionsCsvRequiredcolumns:UrlNameOptionalcolumns:UrlPathDefaultLinkPermissionDefaultSharingLinkTypeSharingAllowedDomainsOneormorestringsseparatedbyacomma,withthewholestringsurroundedbyquotes.Example:"contoso.com,fabrikam.com"SharingBlockedDomainsOneormorestringsseparatedbyacomma,withthewholestringsurroundedbyquotes.Example:"contoso.com,fabrikam.com"SharingCapabilitySharingDomainRestrictionMode```###OUTPUTS```AllErrorMessagesAstringcontainingalltheerrormessageswhichweregeneratedoverthecourseofthistask.```###NOTES```Version:1.0Lastupdated:27December2018Copyright(c)BitTitan,Inc.Allrightsreserved.LicensedundertheMITLicense.```
